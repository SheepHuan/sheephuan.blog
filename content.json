{"pages":[{"title":"About","text":"Hello!","link":"/about/index.html"}],"posts":[{"title":"Docker 配置桌面 + VNC Server","text":"面向docker hub构建12345678docker pull sheephuan/vnc4docker:ubuntu2004-xfce4-20220531docker run --privileged -itd -p 22001:22 -p 15901:5901 --name ubuntu-xfce4 vnc-ubuntu2004:xcfe4 /usr/sbin/initdocker exec -it ubuntu-xfce4 /bin/bash# vncserver 默认密码123456vncserver :1 -localhost no 从零开始构建构建Dokcer1234567docker pull ubuntu:focal-20200423# -v hostdir:dockerdir# 注意这样启动 无法正常使用systemctl命令docker run -it -p 22001:22 -p 15902:5901 --name xfce4 ubuntu:focal-20200423 /bin/bash#启动docker exec -it huany /bin/bash apt换源12345# 备份cp /etc/apt/sources.list /etc/apt/sources.list.bakrm /etc/apt/sources.listvim /etc/apt/sources.list 阿里云https://developer.aliyun.com/mirror/ubuntu 1234567891011121314deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse# deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse# deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse 清华开源镜像站https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/ 123456789101112131415# 20.04 LTS# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释# 记得把https换成httpdeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiversedeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiversedeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiversedeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse# 预发布软件源，不建议启用# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse 中科大https://mirrors.ustc.edu.cn/help/ubuntu.html?highlight=ubuntu 12345678910111213141516# 默认注释了源码仓库，如有需要可自行取消注释deb http://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiversedeb http://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse# 预发布软件源，不建议启用# deb https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse 安装桌面环境 xfce4+tigervnc安装123apt updateapt install xfce4 xfce4-goodies -yapt install tigervnc-standalone-server -y 配置vnc设置vnc密码1234# 设置vnc密码vncpasswd# 输入两次密码# 第三次的view-only password 输入 n 即可 设置vnc启动桌面12# 编写xstartup文件，vim /root/.vnc/xstartup 12345#输入以下内容#!/bin/shunset SESSION_MANAGERunset DBUS_SESSION_BUS_ADDRESSexec startxfce4 12# 设置启动权限chmod u+x /root/.vnc/xstartup 设置vnc显示选项123456# in /root/.vnc/config# vim /root/.vnc/configgeometry=1920x1080dpi=128 启动vnc12# -localhost no表示其他IP可以访问，否则只能本地访问vncserver -localhost no 设置 VNC 为 系统服务(我没做)1vim /etc/systemd/system/vncserver@.service 123456789101112131415[Unit]Description=Remote desktop service (VNC)After=syslog.target network.target[Service]Type=simpleUser=linuxizePAMName=loginPIDFile=/home/%u/.vnc/%H%i.pidExecStartPre=/bin/sh -c '/usr/bin/vncserver -kill :%i &gt; /dev/null 2&gt;&amp;1 || :'ExecStart=/usr/bin/vncserver :%i -geometry 1920x1080 -alwaysshared -fgExecStop=/usr/bin/vncserver -kill :%i[Install]WantedBy=multi-user.target 保存此文件 123456# 配置文件生效systemctl daemon-reload# 设为开机启动systemctl enable vncserver@1.servicesystemctl start vncserver@1.servicesystemctl status vncserver@1.service 打包镜像12345678910111213docker commit xfce4 vnc-ubuntu2004:xcfe4# 容器长传docker tag vnc-ubuntu2004:xcfe4 sheephuan/vnc4docker:ubuntu2004-xfce4-20220531docker logindocker push sheephuan/vnc4docker:ubuntu2004-xfce4-20220531docker save -o vnc-ubuntu2004-xcfe4.tar vnc-ubuntu2004:xcfe4# 在新服务载入docker load --input vnc-ubuntu2004-xcfe4.tar 考虑学习写一个Dockerfile 问题System has not been booted with systemd as init system (PID 1). Can’t operate.1docker run --privileged -itd -p 22004:22 -p 15904:5901 --name txfce4 vnc-ubuntu2004:xcfe4 /usr/sbin/init Failed to exec default Terminal Emulator https://blog.csdn.net/weixin_42912498/article/details/107162983","link":"/posts/8ab24eb0/"},{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/posts/4a17b156/"}],"tags":[{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"}],"categories":[{"name":"开发环境","slug":"开发环境","link":"/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"}]}